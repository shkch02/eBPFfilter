opeanat2감시 구현 성공

후킹대상 시스템 콜:__x64_sys_openat2

실행파일 실행
$sudo ./openat2_monitor_user

필터링 조건문

없음. 필터링안함

작동 결과
다른 터미널에서 컨테이너 생성시 symlinkat감지함

  로그
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415471 COMM=runc:[2:INIT]    PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415460 COMM=runc             PATH=""
[OPENAT2] PID=1415491 COMM=runc             PATH=""
[OPENAT2] PID=1415491 COMM=runc             PATH=""
[OPENAT2] PID=1415491 COMM=runc             PATH=""
[OPENAT2] PID=1415498 COMM=runc             PATH=""
[OPENAT2] PID=1415498 COMM=runc             PATH=""
[OPENAT2] PID=1415498 COMM=runc             PATH=""
[OPENAT2] PID=1415498 COMM=runc             PATH=""



비고
